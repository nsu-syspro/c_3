# Задача №3. Темы: аллокаторы

Условиями задачи №3 являются условия задачи №2 со следующими дополнениями:

- Во входящих данных не допускаются такие математические выражения, результатами которых являются отрицательные числа. Ваше решение может полагаться на это.
- Переводом строки считаются символ \n и, на Windows платформе, последовательность \r\n. Разрешено не обрабатывать \r\n (или упрощать её до \n), но требуется полная работоспособность на тестах с \n.
- Решение должно использовать собственный аллокатор (детали ниже) c размерами ARENA_SIZE равным 500 МB, BLOCK_SIZE (в случае пул-аллокатора) равным 2 KB.

# Аллокатор

Вам необходимо реализовать собственный *аллокатор* - механизм выделения и освобождения динамической памяти, аналогичный стандартным функциям malloc, realloc, calloc и free, работающий следующим образом:

- При создании аллокатор выделяет стандартными средствами (malloc) в динамическом классе памяти большой объём (*арену*) заданного размера (ARENA_SIZE).
- Каждая функция выделения памяти (аналоги malloc, realloc, calloc) возвращает либо указатель на свободный участок памяти внутри арены, либо NULL, если свободной памяти внутри арены нет.
- Функция освобождения памяти (аналог free) может освободить участок памяти (позволить переиспользовать его).

Есть множество разных алгоритмов аллокации, оптимизирующих те или иные критерии качества: время работы функций, объём дополнительной памяти, нагрузки на фрагментацию. Вам предлагается реализовать на выбор за разное количество баллов один из следующих вариантов:

## Линейный аллокатор (5 баллов)

Ограничения на время работы всех функций и дополнительную память - O(1); функция free не приводит к освобождению участка.

## Стековый аллокатор (10 баллов)

Ограничение на время работы всех функций - O(1), дополнительная память расходуется в размере не более одного указателя на один выделяемый участок памяти.
Функция free приводит к освобождению участка, если тот был выделен последним, либо все выделенные после него уже были освобождены.

## Стековый аллокатор с удалением из середины (13 баллов)

Аналогично предыдущему варианту, но ограничение на время работы функции free допускается O(1) амортизированное, и освобождение участка из середины арены
происходит тогда, когда будут освобождены все участки, находящиеся после него в арене.

## Пул-аллокатор (15 баллов)

Ограничение на время работы всех функций и дополнительную память - O(1), любой освобождаемый участок может быть переиспользован сразу после удаления. В таком аллокаторе все участки равны размеру
BLOCK_SIZE, то есть, попытка выделить участок размером меньше приводит к лишней трате объёма арены, а попытка выделить участок размером больше проваливается (возвращает NULL).

## Пул-аллокатор c аренами, специализированными под размер (20 баллов)

Аналогично предыдущему пункту, но решена проблема с лишней тратой объёма арены. Для этого заводятся специализированные арены под маленькие размеры участков с шагом в 8 байт
(8 байт, 16 байт, 24 байта, ..., N байт), плюс одна арена с максимальным размером (BLOCK_SIZE). Для аллокации участка выбирается арена с минимальным расходом лишнего объёма. Выбор арены должен
происходить за O(1). При прохождении тестов устанавливайте значение N равное случайному числу от 64 до 256 включительно, кратному 8. Размер специализрованных арен равен 10 MB.
